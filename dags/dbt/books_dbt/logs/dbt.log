[0m03:59:35.991306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969086d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d73b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9690a710>]}


============================== 03:59:35.995713 | 5bc891c1-9415-496f-8954-87f7a78a5560 ==============================
[0m03:59:35.995713 [info ] [MainThread]: Running with dbt=1.10.9
[0m03:59:35.996147 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'invocation_command': 'dbt deps', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/dags/dbt/books_dbt', 'log_path': '/opt/airflow/dags/dbt/books_dbt/logs', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'empty': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'target_path': 'None', 'printer_width': '80', 'use_experimental_parser': 'False'}
[0m03:59:36.082467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bc891c1-9415-496f-8954-87f7a78a5560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969cbbd0>]}
[0m03:59:36.116697 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:59:36.117921 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:59:36.118989 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15648234, "process_in_blocks": "1152", "process_kernel_time": 0.305782, "process_mem_max_rss": "108004", "process_out_blocks": "2331", "process_user_time": 1.263498}
[0m03:59:36.119327 [debug] [MainThread]: Command `dbt deps` succeeded at 03:59:36.119258 after 0.16 seconds
[0m03:59:36.119568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b676bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96937d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96934a10>]}
[0m03:59:36.120009 [debug] [MainThread]: Flushing usage events
[0m03:59:38.177024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:59:39.445392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabd97390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabf6ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabcfbe10>]}


============================== 03:59:39.455077 | 14bf014b-6eef-4a44-8a25-9ed04018d256 ==============================
[0m03:59:39.455077 [info ] [MainThread]: Running with dbt=1.10.9
[0m03:59:39.460262 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'empty': 'False', 'introspect': 'True', 'printer_width': '80', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dags/dbt/books_dbt/logs', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt build --profiles-dir .', 'profiles_dir': '.', 'debug': 'False'}
[0m03:59:39.642405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14bf014b-6eef-4a44-8a25-9ed04018d256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb733d0>]}
[0m03:59:39.674344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14bf014b-6eef-4a44-8a25-9ed04018d256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7bb790>]}
[0m03:59:39.675535 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m03:59:39.712562 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m03:59:39.713237 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:59:39.713720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '14bf014b-6eef-4a44-8a25-9ed04018d256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb54550>]}
[0m03:59:40.391297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14bf014b-6eef-4a44-8a25-9ed04018d256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa825c8d0>]}
[0m03:59:40.449491 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt/books_dbt/target/manifest.json
[0m03:59:40.452712 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt/books_dbt/target/semantic_manifest.json
[0m03:59:40.485410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14bf014b-6eef-4a44-8a25-9ed04018d256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa75ce790>]}
[0m03:59:40.485887 [info ] [MainThread]: Found 2 models, 4 data tests, 429 macros
[0m03:59:40.487821 [info ] [MainThread]: 
[0m03:59:40.488296 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:59:40.488849 [info ] [MainThread]: 
[0m03:59:40.490352 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:59:40.493556 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_books'
[0m03:59:40.540757 [debug] [ThreadPool]: Using duckdb connection "list_books"
[0m03:59:40.541668 [debug] [ThreadPool]: On list_books: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "connection_name": "list_books"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"books"'
    
  
  
[0m03:59:40.542622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:59:40.556498 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "connection_name": "list_books"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"books"'
    
  
  
[0m03:59:40.556896 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m03:59:40.557521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:59:40.557773 [debug] [MainThread]: Connection 'list_books' was properly closed.
[0m03:59:40.558023 [info ] [MainThread]: 
[0m03:59:40.559634 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m03:59:40.560223 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/opt/airflow/data/warehouse/books.duckdb": No such file or directory
[0m03:59:40.561412 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.1467583, "process_in_blocks": "1576", "process_kernel_time": 0.325347, "process_mem_max_rss": "152164", "process_out_blocks": "1744", "process_user_time": 1.881578}
[0m03:59:40.562301 [debug] [MainThread]: Command `dbt build` failed at 03:59:40.562197 after 1.15 seconds
[0m03:59:40.562724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0802cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb013d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb06bd550>]}
[0m03:59:40.563174 [debug] [MainThread]: Flushing usage events
[0m03:59:42.356898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:02:18.520831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3dfbbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3de4510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3de4390>]}


============================== 04:02:18.525089 | 5cdbc617-920d-4942-ab9e-fdd1d7901875 ==============================
[0m04:02:18.525089 [info ] [MainThread]: Running with dbt=1.10.9
[0m04:02:18.526537 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'profiles_dir': '/opt/airflow/dags/dbt/books_dbt', 'empty': 'None', 'printer_width': '80', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'introspect': 'True', 'log_format': 'default', 'partial_parse': 'True', 'quiet': 'False', 'use_colors': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/books_dbt/logs', 'version_check': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager'}
[0m04:02:18.632318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cdbc617-920d-4942-ab9e-fdd1d7901875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b01990>]}
[0m04:02:18.638258 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m04:02:18.639523 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m04:02:18.640493 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14863755, "process_in_blocks": "33728", "process_kernel_time": 0.209259, "process_mem_max_rss": "104860", "process_out_blocks": "3", "process_user_time": 0.965194}
[0m04:02:18.640852 [debug] [MainThread]: Command `dbt deps` succeeded at 04:02:18.640773 after 0.15 seconds
[0m04:02:18.641122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8992c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c2bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89093d0>]}
[0m04:02:18.641380 [debug] [MainThread]: Flushing usage events
[0m04:02:19.794070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:02:20.876086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd974d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bce8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcfbcd0>]}


============================== 04:02:20.879345 | e754b203-0af0-4260-9fd1-53ceb94aae31 ==============================
[0m04:02:20.879345 [info ] [MainThread]: Running with dbt=1.10.9
[0m04:02:20.880366 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --profiles-dir .', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'warn_error': 'None', 'version_check': 'True', 'introspect': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'static_parser': 'True', 'log_path': '/opt/airflow/dags/dbt/books_dbt/logs', 'profiles_dir': '.', 'log_format': 'default', 'partial_parse': 'True', 'log_cache_events': 'False', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False'}
[0m04:02:20.984439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e754b203-0af0-4260-9fd1-53ceb94aae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb69b90>]}
[0m04:02:21.009158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e754b203-0af0-4260-9fd1-53ceb94aae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bbedc50>]}
[0m04:02:21.010088 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m04:02:21.046199 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m04:02:21.097620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:02:21.097919 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:02:21.116275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e754b203-0af0-4260-9fd1-53ceb94aae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983ac050>]}
[0m04:02:21.151535 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt/books_dbt/target/manifest.json
[0m04:02:21.152895 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt/books_dbt/target/semantic_manifest.json
[0m04:02:21.169999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e754b203-0af0-4260-9fd1-53ceb94aae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98003c50>]}
[0m04:02:21.170344 [info ] [MainThread]: Found 2 models, 4 data tests, 429 macros
[0m04:02:21.172071 [info ] [MainThread]: 
[0m04:02:21.172449 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:02:21.172842 [info ] [MainThread]: 
[0m04:02:21.173245 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:02:21.175649 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_books'
[0m04:02:21.222344 [debug] [ThreadPool]: Using duckdb connection "list_books"
[0m04:02:21.222776 [debug] [ThreadPool]: On list_books: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "connection_name": "list_books"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"books"'
    
  
  
[0m04:02:21.223037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:02:21.229006 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "connection_name": "list_books"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"books"'
    
  
  
[0m04:02:21.229314 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m04:02:21.229888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:02:21.230150 [debug] [MainThread]: Connection 'list_books' was properly closed.
[0m04:02:21.230408 [info ] [MainThread]: 
[0m04:02:21.230962 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m04:02:21.231402 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Cannot open file "/opt/airflow/data/warehouse/books.duckdb": No such file or directory
[0m04:02:21.232271 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.3797578, "process_in_blocks": "4800", "process_kernel_time": 0.114273, "process_mem_max_rss": "142652", "process_out_blocks": "884", "process_user_time": 1.170805}
[0m04:02:21.232594 [debug] [MainThread]: Command `dbt build` failed at 04:02:21.232553 after 0.38 seconds
[0m04:02:21.232868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0802cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9801a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05934d0>]}
[0m04:02:21.233142 [debug] [MainThread]: Flushing usage events
[0m04:02:22.073943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:04:24.422918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff924ed010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92303d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff926c1510>]}


============================== 04:04:24.427168 | 927dbcd4-9069-49bf-be17-656ff39c72ce ==============================
[0m04:04:24.427168 [info ] [MainThread]: Running with dbt=1.10.9
[0m04:04:24.429136 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dags/dbt/books_dbt', 'partial_parse': 'True', 'use_colors': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'empty': 'None', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/opt/airflow/dags/dbt/books_dbt/logs', 'fail_fast': 'False', 'target_path': 'None', 'invocation_command': 'dbt deps', 'no_print': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True'}
[0m04:04:24.493216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '927dbcd4-9069-49bf-be17-656ff39c72ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9238efd0>]}
[0m04:04:24.503125 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m04:04:24.504739 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m04:04:24.505841 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11039067, "process_in_blocks": "0", "process_kernel_time": 0.203875, "process_mem_max_rss": "104716", "process_out_blocks": "3", "process_user_time": 1.036365}
[0m04:04:24.506231 [debug] [MainThread]: Command `dbt deps` succeeded at 04:04:24.506152 after 0.11 seconds
[0m04:04:24.506516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9232db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97076bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fab6d0>]}
[0m04:04:24.506829 [debug] [MainThread]: Flushing usage events
[0m04:04:25.267071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:04:26.461029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b19b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b0ec310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b0ff8d0>]}


============================== 04:04:26.464425 | 558747f2-74da-475f-bbba-793712c35e34 ==============================
[0m04:04:26.464425 [info ] [MainThread]: Running with dbt=1.10.9
[0m04:04:26.466573 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_colors': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'target_path': 'None', 'log_path': '/opt/airflow/dags/dbt/books_dbt/logs', 'indirect_selection': 'eager', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'profiles_dir': '.', 'introspect': 'True', 'no_print': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt build --profiles-dir .', 'cache_selected_only': 'False'}
[0m04:04:26.582554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '558747f2-74da-475f-bbba-793712c35e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af5f390>]}
[0m04:04:26.609293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '558747f2-74da-475f-bbba-793712c35e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dc49d90>]}
[0m04:04:26.610595 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m04:04:26.650301 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m04:04:26.716133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:04:26.716565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:04:26.735053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '558747f2-74da-475f-bbba-793712c35e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af6f090>]}
[0m04:04:26.778766 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt/books_dbt/target/manifest.json
[0m04:04:26.780195 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt/books_dbt/target/semantic_manifest.json
[0m04:04:26.800327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '558747f2-74da-475f-bbba-793712c35e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77407a10>]}
[0m04:04:26.800782 [info ] [MainThread]: Found 2 models, 4 data tests, 429 macros
[0m04:04:26.802367 [info ] [MainThread]: 
[0m04:04:26.802769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:04:26.803154 [info ] [MainThread]: 
[0m04:04:26.803713 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:04:26.806379 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_books'
[0m04:04:26.873539 [debug] [ThreadPool]: Using duckdb connection "list_books"
[0m04:04:26.873935 [debug] [ThreadPool]: On list_books: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "connection_name": "list_books"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"books"'
    
  
  
[0m04:04:26.874165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:04:26.895042 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m04:04:26.896317 [debug] [ThreadPool]: On list_books: Close
[0m04:04:26.897019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_books, now create_books_main)
[0m04:04:26.897398 [debug] [ThreadPool]: Creating schema "database: "books"
schema: "main"
"
[0m04:04:26.901325 [debug] [ThreadPool]: Using duckdb connection "create_books_main"
[0m04:04:26.901663 [debug] [ThreadPool]: On create_books_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "connection_name": "create_books_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='books'
        and type='sqlite'
    
  
[0m04:04:26.902000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:04:26.902697 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:04:26.903583 [debug] [ThreadPool]: Using duckdb connection "create_books_main"
[0m04:04:26.903831 [debug] [ThreadPool]: On create_books_main: BEGIN
[0m04:04:26.904268 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:04:26.904519 [debug] [ThreadPool]: Using duckdb connection "create_books_main"
[0m04:04:26.904785 [debug] [ThreadPool]: On create_books_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "connection_name": "create_books_main"} */

    
    
        create schema if not exists "books"."main"
    
[0m04:04:26.905245 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:04:26.905751 [debug] [ThreadPool]: On create_books_main: COMMIT
[0m04:04:26.905995 [debug] [ThreadPool]: Using duckdb connection "create_books_main"
[0m04:04:26.906265 [debug] [ThreadPool]: On create_books_main: COMMIT
[0m04:04:26.906639 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m04:04:26.906892 [debug] [ThreadPool]: On create_books_main: Close
[0m04:04:26.907825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_books_main, now list_books_main)
[0m04:04:26.910745 [debug] [ThreadPool]: Using duckdb connection "list_books_main"
[0m04:04:26.910992 [debug] [ThreadPool]: On list_books_main: BEGIN
[0m04:04:26.911212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:04:26.911759 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m04:04:26.912015 [debug] [ThreadPool]: Using duckdb connection "list_books_main"
[0m04:04:26.912250 [debug] [ThreadPool]: On list_books_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "connection_name": "list_books_main"} */
select
      'books' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'books'
  
[0m04:04:26.917967 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m04:04:26.918718 [debug] [ThreadPool]: On list_books_main: ROLLBACK
[0m04:04:26.919359 [debug] [ThreadPool]: Failed to rollback 'list_books_main'
[0m04:04:26.919616 [debug] [ThreadPool]: On list_books_main: Close
[0m04:04:26.920103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '558747f2-74da-475f-bbba-793712c35e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77875150>]}
[0m04:04:26.920483 [debug] [MainThread]: Using duckdb connection "master"
[0m04:04:26.920726 [debug] [MainThread]: On master: BEGIN
[0m04:04:26.920978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:04:26.921417 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:04:26.921652 [debug] [MainThread]: On master: COMMIT
[0m04:04:26.921896 [debug] [MainThread]: Using duckdb connection "master"
[0m04:04:26.922127 [debug] [MainThread]: On master: COMMIT
[0m04:04:26.922507 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:04:26.922762 [debug] [MainThread]: On master: Close
[0m04:04:26.926768 [debug] [Thread-1 (]: Began running node model.books_dbt.stg_books
[0m04:04:26.927115 [info ] [Thread-1 (]: 1 of 6 START sql table model main.stg_books .................................... [RUN]
[0m04:04:26.927688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_books_main, now model.books_dbt.stg_books)
[0m04:04:26.927998 [debug] [Thread-1 (]: Began compiling node model.books_dbt.stg_books
[0m04:04:26.931383 [debug] [Thread-1 (]: Writing injected SQL for node "model.books_dbt.stg_books"
[0m04:04:26.932717 [debug] [Thread-1 (]: Began executing node model.books_dbt.stg_books
[0m04:04:26.959170 [debug] [Thread-1 (]: Writing runtime sql for node "model.books_dbt.stg_books"
[0m04:04:26.962029 [debug] [Thread-1 (]: Using duckdb connection "model.books_dbt.stg_books"
[0m04:04:26.962478 [debug] [Thread-1 (]: On model.books_dbt.stg_books: BEGIN
[0m04:04:26.962831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:04:26.963954 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:04:26.964283 [debug] [Thread-1 (]: Using duckdb connection "model.books_dbt.stg_books"
[0m04:04:26.964647 [debug] [Thread-1 (]: On model.books_dbt.stg_books: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "node_id": "model.books_dbt.stg_books"} */

  
    
    

    create  table
      "books"."main"."stg_books__dbt_tmp"
  
    as (
      WITH src AS (
  SELECT * FROM read_parquet('/opt/airflow/data/raw/*.parquet')
)
SELECT
  date_scraped::DATE as date_scraped,
  title,
  product_page,
  price_gbp,
  availability,
  rating,
  category
FROM src
    );
  
  
[0m04:04:26.968803 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m04:04:26.974992 [debug] [Thread-1 (]: Using duckdb connection "model.books_dbt.stg_books"
[0m04:04:26.975497 [debug] [Thread-1 (]: On model.books_dbt.stg_books: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "node_id": "model.books_dbt.stg_books"} */
alter table "books"."main"."stg_books__dbt_tmp" rename to "stg_books"
[0m04:04:26.976342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:04:26.982941 [debug] [Thread-1 (]: On model.books_dbt.stg_books: COMMIT
[0m04:04:26.983228 [debug] [Thread-1 (]: Using duckdb connection "model.books_dbt.stg_books"
[0m04:04:26.983476 [debug] [Thread-1 (]: On model.books_dbt.stg_books: COMMIT
[0m04:04:26.984474 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m04:04:26.987511 [debug] [Thread-1 (]: Using duckdb connection "model.books_dbt.stg_books"
[0m04:04:26.987873 [debug] [Thread-1 (]: On model.books_dbt.stg_books: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "node_id": "model.books_dbt.stg_books"} */

      drop table if exists "books"."main"."stg_books__dbt_backup" cascade
    
[0m04:04:26.988521 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m04:04:26.990166 [debug] [Thread-1 (]: On model.books_dbt.stg_books: Close
[0m04:04:26.991710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558747f2-74da-475f-bbba-793712c35e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af064d0>]}
[0m04:04:26.992415 [info ] [Thread-1 (]: 1 of 6 OK created sql table model main.stg_books ............................... [[32mOK[0m in 0.06s]
[0m04:04:26.992983 [debug] [Thread-1 (]: Finished running node model.books_dbt.stg_books
[0m04:04:26.993811 [debug] [Thread-3 (]: Began running node test.books_dbt.not_null_stg_books_date_scraped.3674568b09
[0m04:04:26.994014 [debug] [Thread-4 (]: Began running node test.books_dbt.not_null_stg_books_product_page.4472631720
[0m04:04:26.994216 [debug] [Thread-2 (]: Began running node test.books_dbt.not_null_stg_books_title.a20d33c982
[0m04:04:26.994435 [debug] [Thread-1 (]: Began running node test.books_dbt.unique_stg_books_product_page.4432f50b27
[0m04:04:26.994602 [info ] [Thread-3 (]: 2 of 6 START test not_null_stg_books_date_scraped .............................. [RUN]
[0m04:04:26.994975 [info ] [Thread-4 (]: 3 of 6 START test not_null_stg_books_product_page .............................. [RUN]
[0m04:04:26.995402 [info ] [Thread-2 (]: 4 of 6 START test not_null_stg_books_title ..................................... [RUN]
[0m04:04:26.995814 [info ] [Thread-1 (]: 5 of 6 START test unique_stg_books_product_page ................................ [RUN]
[0m04:04:26.996403 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.books_dbt.not_null_stg_books_date_scraped.3674568b09'
[0m04:04:26.996809 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.books_dbt.not_null_stg_books_product_page.4472631720'
[0m04:04:26.997876 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.books_dbt.not_null_stg_books_title.a20d33c982'
[0m04:04:26.998727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.books_dbt.stg_books, now test.books_dbt.unique_stg_books_product_page.4432f50b27)
[0m04:04:26.999112 [debug] [Thread-3 (]: Began compiling node test.books_dbt.not_null_stg_books_date_scraped.3674568b09
[0m04:04:26.999461 [debug] [Thread-4 (]: Began compiling node test.books_dbt.not_null_stg_books_product_page.4472631720
[0m04:04:26.999788 [debug] [Thread-2 (]: Began compiling node test.books_dbt.not_null_stg_books_title.a20d33c982
[0m04:04:27.000041 [debug] [Thread-1 (]: Began compiling node test.books_dbt.unique_stg_books_product_page.4432f50b27
[0m04:04:27.006802 [debug] [Thread-3 (]: Writing injected SQL for node "test.books_dbt.not_null_stg_books_date_scraped.3674568b09"
[0m04:04:27.008917 [debug] [Thread-4 (]: Writing injected SQL for node "test.books_dbt.not_null_stg_books_product_page.4472631720"
[0m04:04:27.010909 [debug] [Thread-2 (]: Writing injected SQL for node "test.books_dbt.not_null_stg_books_title.a20d33c982"
[0m04:04:27.014153 [debug] [Thread-1 (]: Writing injected SQL for node "test.books_dbt.unique_stg_books_product_page.4432f50b27"
[0m04:04:27.015910 [debug] [Thread-3 (]: Began executing node test.books_dbt.not_null_stg_books_date_scraped.3674568b09
[0m04:04:27.018121 [debug] [Thread-1 (]: Began executing node test.books_dbt.unique_stg_books_product_page.4432f50b27
[0m04:04:27.030980 [debug] [Thread-3 (]: Writing runtime sql for node "test.books_dbt.not_null_stg_books_date_scraped.3674568b09"
[0m04:04:27.031442 [debug] [Thread-2 (]: Began executing node test.books_dbt.not_null_stg_books_title.a20d33c982
[0m04:04:27.032842 [debug] [Thread-1 (]: Writing runtime sql for node "test.books_dbt.unique_stg_books_product_page.4432f50b27"
[0m04:04:27.033227 [debug] [Thread-4 (]: Began executing node test.books_dbt.not_null_stg_books_product_page.4472631720
[0m04:04:27.034544 [debug] [Thread-2 (]: Writing runtime sql for node "test.books_dbt.not_null_stg_books_title.a20d33c982"
[0m04:04:27.037160 [debug] [Thread-4 (]: Writing runtime sql for node "test.books_dbt.not_null_stg_books_product_page.4472631720"
[0m04:04:27.037720 [debug] [Thread-1 (]: Using duckdb connection "test.books_dbt.unique_stg_books_product_page.4432f50b27"
[0m04:04:27.037963 [debug] [Thread-3 (]: Using duckdb connection "test.books_dbt.not_null_stg_books_date_scraped.3674568b09"
[0m04:04:27.038306 [debug] [Thread-1 (]: On test.books_dbt.unique_stg_books_product_page.4432f50b27: BEGIN
[0m04:04:27.038541 [debug] [Thread-2 (]: Using duckdb connection "test.books_dbt.not_null_stg_books_title.a20d33c982"
[0m04:04:27.038763 [debug] [Thread-3 (]: On test.books_dbt.not_null_stg_books_date_scraped.3674568b09: BEGIN
[0m04:04:27.038960 [debug] [Thread-4 (]: Using duckdb connection "test.books_dbt.not_null_stg_books_product_page.4472631720"
[0m04:04:27.039860 [debug] [Thread-4 (]: On test.books_dbt.not_null_stg_books_product_page.4472631720: BEGIN
[0m04:04:27.039420 [debug] [Thread-2 (]: On test.books_dbt.not_null_stg_books_title.a20d33c982: BEGIN
[0m04:04:27.039657 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:04:27.039164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:04:27.040035 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:04:27.040250 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:04:27.040974 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m04:04:27.041159 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m04:04:27.042518 [debug] [Thread-3 (]: Using duckdb connection "test.books_dbt.not_null_stg_books_date_scraped.3674568b09"
[0m04:04:27.042090 [debug] [Thread-1 (]: Using duckdb connection "test.books_dbt.unique_stg_books_product_page.4432f50b27"
[0m04:04:27.042294 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m04:04:27.041676 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m04:04:27.042715 [debug] [Thread-3 (]: On test.books_dbt.not_null_stg_books_date_scraped.3674568b09: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "node_id": "test.books_dbt.not_null_stg_books_date_scraped.3674568b09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_scraped
from "books"."main"."stg_books"
where date_scraped is null



  
  
      
    ) dbt_internal_test
[0m04:04:27.042965 [debug] [Thread-1 (]: On test.books_dbt.unique_stg_books_product_page.4432f50b27: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "node_id": "test.books_dbt.unique_stg_books_product_page.4432f50b27"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_page as unique_field,
    count(*) as n_records

from "books"."main"."stg_books"
where product_page is not null
group by product_page
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m04:04:27.043229 [debug] [Thread-2 (]: Using duckdb connection "test.books_dbt.not_null_stg_books_title.a20d33c982"
[0m04:04:27.043429 [debug] [Thread-4 (]: Using duckdb connection "test.books_dbt.not_null_stg_books_product_page.4472631720"
[0m04:04:27.043981 [debug] [Thread-2 (]: On test.books_dbt.not_null_stg_books_title.a20d33c982: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "node_id": "test.books_dbt.not_null_stg_books_title.a20d33c982"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select title
from "books"."main"."stg_books"
where title is null



  
  
      
    ) dbt_internal_test
[0m04:04:27.044246 [debug] [Thread-4 (]: On test.books_dbt.not_null_stg_books_product_page.4472631720: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "node_id": "test.books_dbt.not_null_stg_books_product_page.4472631720"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_page
from "books"."main"."stg_books"
where product_page is null



  
  
      
    ) dbt_internal_test
[0m04:04:27.045073 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m04:04:27.045355 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m04:04:27.047568 [debug] [Thread-2 (]: On test.books_dbt.not_null_stg_books_title.a20d33c982: ROLLBACK
[0m04:04:27.047773 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m04:04:27.047971 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m04:04:27.048656 [debug] [Thread-3 (]: On test.books_dbt.not_null_stg_books_date_scraped.3674568b09: ROLLBACK
[0m04:04:27.049037 [debug] [Thread-2 (]: Failed to rollback 'test.books_dbt.not_null_stg_books_title.a20d33c982'
[0m04:04:27.049699 [debug] [Thread-1 (]: On test.books_dbt.unique_stg_books_product_page.4432f50b27: ROLLBACK
[0m04:04:27.050392 [debug] [Thread-4 (]: On test.books_dbt.not_null_stg_books_product_page.4472631720: ROLLBACK
[0m04:04:27.050687 [debug] [Thread-3 (]: Failed to rollback 'test.books_dbt.not_null_stg_books_date_scraped.3674568b09'
[0m04:04:27.050940 [debug] [Thread-2 (]: On test.books_dbt.not_null_stg_books_title.a20d33c982: Close
[0m04:04:27.051245 [debug] [Thread-1 (]: Failed to rollback 'test.books_dbt.unique_stg_books_product_page.4432f50b27'
[0m04:04:27.051517 [debug] [Thread-4 (]: Failed to rollback 'test.books_dbt.not_null_stg_books_product_page.4472631720'
[0m04:04:27.051756 [debug] [Thread-3 (]: On test.books_dbt.not_null_stg_books_date_scraped.3674568b09: Close
[0m04:04:27.052209 [info ] [Thread-2 (]: 4 of 6 PASS not_null_stg_books_title ........................................... [[32mPASS[0m in 0.05s]
[0m04:04:27.052401 [debug] [Thread-1 (]: On test.books_dbt.unique_stg_books_product_page.4432f50b27: Close
[0m04:04:27.052656 [debug] [Thread-4 (]: On test.books_dbt.not_null_stg_books_product_page.4472631720: Close
[0m04:04:27.052989 [info ] [Thread-3 (]: 2 of 6 PASS not_null_stg_books_date_scraped .................................... [[32mPASS[0m in 0.06s]
[0m04:04:27.053322 [debug] [Thread-2 (]: Finished running node test.books_dbt.not_null_stg_books_title.a20d33c982
[0m04:04:27.053702 [info ] [Thread-1 (]: 5 of 6 PASS unique_stg_books_product_page ...................................... [[32mPASS[0m in 0.06s]
[0m04:04:27.054015 [info ] [Thread-4 (]: 3 of 6 PASS not_null_stg_books_product_page .................................... [[32mPASS[0m in 0.06s]
[0m04:04:27.054311 [debug] [Thread-3 (]: Finished running node test.books_dbt.not_null_stg_books_date_scraped.3674568b09
[0m04:04:27.054765 [debug] [Thread-1 (]: Finished running node test.books_dbt.unique_stg_books_product_page.4432f50b27
[0m04:04:27.055016 [debug] [Thread-4 (]: Finished running node test.books_dbt.not_null_stg_books_product_page.4472631720
[0m04:04:27.055794 [debug] [Thread-2 (]: Began running node model.books_dbt.fct_prices_by_rating
[0m04:04:27.056101 [info ] [Thread-2 (]: 6 of 6 START sql table model main.fct_prices_by_rating ......................... [RUN]
[0m04:04:27.056393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.books_dbt.not_null_stg_books_title.a20d33c982, now model.books_dbt.fct_prices_by_rating)
[0m04:04:27.056623 [debug] [Thread-2 (]: Began compiling node model.books_dbt.fct_prices_by_rating
[0m04:04:27.058059 [debug] [Thread-2 (]: Writing injected SQL for node "model.books_dbt.fct_prices_by_rating"
[0m04:04:27.059772 [debug] [Thread-2 (]: Began executing node model.books_dbt.fct_prices_by_rating
[0m04:04:27.062226 [debug] [Thread-2 (]: Writing runtime sql for node "model.books_dbt.fct_prices_by_rating"
[0m04:04:27.063164 [debug] [Thread-2 (]: Using duckdb connection "model.books_dbt.fct_prices_by_rating"
[0m04:04:27.063387 [debug] [Thread-2 (]: On model.books_dbt.fct_prices_by_rating: BEGIN
[0m04:04:27.063589 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:04:27.064212 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m04:04:27.064409 [debug] [Thread-2 (]: Using duckdb connection "model.books_dbt.fct_prices_by_rating"
[0m04:04:27.064674 [debug] [Thread-2 (]: On model.books_dbt.fct_prices_by_rating: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "node_id": "model.books_dbt.fct_prices_by_rating"} */

  
    
    

    create  table
      "books"."main"."fct_prices_by_rating__dbt_tmp"
  
    as (
      SELECT
  date_scraped,
  rating,
  COUNT(*) AS n_books,
  AVG(price_gbp) AS avg_price_gbp,
  MIN(price_gbp) AS min_price_gbp,
  MAX(price_gbp) AS max_price_gbp
FROM "books"."main"."stg_books"
GROUP BY 1,2
ORDER BY 1,2
    );
  
  
[0m04:04:27.066204 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m04:04:27.067746 [debug] [Thread-2 (]: Using duckdb connection "model.books_dbt.fct_prices_by_rating"
[0m04:04:27.067968 [debug] [Thread-2 (]: On model.books_dbt.fct_prices_by_rating: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "node_id": "model.books_dbt.fct_prices_by_rating"} */
alter table "books"."main"."fct_prices_by_rating__dbt_tmp" rename to "fct_prices_by_rating"
[0m04:04:27.068357 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m04:04:27.069316 [debug] [Thread-2 (]: On model.books_dbt.fct_prices_by_rating: COMMIT
[0m04:04:27.070987 [debug] [Thread-2 (]: Using duckdb connection "model.books_dbt.fct_prices_by_rating"
[0m04:04:27.071248 [debug] [Thread-2 (]: On model.books_dbt.fct_prices_by_rating: COMMIT
[0m04:04:27.071916 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m04:04:27.073264 [debug] [Thread-2 (]: Using duckdb connection "model.books_dbt.fct_prices_by_rating"
[0m04:04:27.073481 [debug] [Thread-2 (]: On model.books_dbt.fct_prices_by_rating: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "node_id": "model.books_dbt.fct_prices_by_rating"} */

      drop table if exists "books"."main"."fct_prices_by_rating__dbt_backup" cascade
    
[0m04:04:27.073820 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m04:04:27.074472 [debug] [Thread-2 (]: On model.books_dbt.fct_prices_by_rating: Close
[0m04:04:27.074870 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558747f2-74da-475f-bbba-793712c35e34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7672b190>]}
[0m04:04:27.075264 [info ] [Thread-2 (]: 6 of 6 OK created sql table model main.fct_prices_by_rating .................... [[32mOK[0m in 0.02s]
[0m04:04:27.075594 [debug] [Thread-2 (]: Finished running node model.books_dbt.fct_prices_by_rating
[0m04:04:27.076582 [debug] [MainThread]: Using duckdb connection "master"
[0m04:04:27.076804 [debug] [MainThread]: On master: BEGIN
[0m04:04:27.076969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:04:27.077404 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:04:27.077597 [debug] [MainThread]: On master: COMMIT
[0m04:04:27.077764 [debug] [MainThread]: Using duckdb connection "master"
[0m04:04:27.077910 [debug] [MainThread]: On master: COMMIT
[0m04:04:27.078191 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m04:04:27.078393 [debug] [MainThread]: On master: Close
[0m04:04:27.078634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:04:27.078797 [debug] [MainThread]: Connection 'test.books_dbt.unique_stg_books_product_page.4432f50b27' was properly closed.
[0m04:04:27.078941 [debug] [MainThread]: Connection 'test.books_dbt.not_null_stg_books_date_scraped.3674568b09' was properly closed.
[0m04:04:27.079085 [debug] [MainThread]: Connection 'test.books_dbt.not_null_stg_books_product_page.4472631720' was properly closed.
[0m04:04:27.079259 [debug] [MainThread]: Connection 'model.books_dbt.fct_prices_by_rating' was properly closed.
[0m04:04:27.079528 [info ] [MainThread]: 
[0m04:04:27.079762 [info ] [MainThread]: Finished running 2 table models, 4 data tests in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m04:04:27.080563 [debug] [MainThread]: Command end result
[0m04:04:27.094805 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt/books_dbt/target/manifest.json
[0m04:04:27.096222 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt/books_dbt/target/semantic_manifest.json
[0m04:04:27.100075 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dags/dbt/books_dbt/target/run_results.json
[0m04:04:27.100273 [info ] [MainThread]: 
[0m04:04:27.100527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:04:27.100944 [info ] [MainThread]: 
[0m04:04:27.101337 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m04:04:27.102203 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.66636676, "process_in_blocks": "480", "process_kernel_time": 0.218791, "process_mem_max_rss": "158880", "process_out_blocks": "1844", "process_user_time": 1.447853}
[0m04:04:27.102541 [debug] [MainThread]: Command `dbt build` succeeded at 04:04:27.102496 after 0.67 seconds
[0m04:04:27.102768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7af2fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fc76c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb5f5d0>]}
[0m04:04:27.103010 [debug] [MainThread]: Flushing usage events
[0m04:04:27.945367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:07:25.043162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ade8150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ade8510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7adabf10>]}


============================== 04:07:25.047419 | 3c02c83f-4374-4164-90fd-ea4da95b176d ==============================
[0m04:07:25.047419 [info ] [MainThread]: Running with dbt=1.10.9
[0m04:07:25.049229 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_format': 'default', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dags/dbt/books_dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt/books_dbt', 'indirect_selection': 'eager', 'warn_error': 'None', 'no_print': 'None', 'use_colors': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt deps', 'version_check': 'True', 'static_parser': 'True'}
[0m04:07:25.106717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c02c83f-4374-4164-90fd-ea4da95b176d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ac87d90>]}
[0m04:07:25.112902 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m04:07:25.114241 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m04:07:25.115008 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.09793392, "process_in_blocks": "192", "process_kernel_time": 0.219776, "process_mem_max_rss": "104852", "process_out_blocks": "3", "process_user_time": 1.018963}
[0m04:07:25.115367 [debug] [MainThread]: Command `dbt deps` succeeded at 04:07:25.115298 after 0.10 seconds
[0m04:07:25.115647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ade8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f960090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9e2d50>]}
[0m04:07:25.115918 [debug] [MainThread]: Flushing usage events
[0m04:07:26.471859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:07:28.117165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e0b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2189f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e09e90>]}


============================== 04:07:28.121932 | b17d03de-1075-41df-b829-4cd38ffded5b ==============================
[0m04:07:28.121932 [info ] [MainThread]: Running with dbt=1.10.9
[0m04:07:28.125420 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --profiles-dir .', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'no_print': 'None', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'log_format': 'default', 'empty': 'False', 'log_path': '/opt/airflow/dags/dbt/books_dbt/logs', 'log_cache_events': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'static_parser': 'True', 'use_colors': 'True'}
[0m04:07:28.265759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b17d03de-1075-41df-b829-4cd38ffded5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e67610>]}
[0m04:07:28.292360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b17d03de-1075-41df-b829-4cd38ffded5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4b47810>]}
[0m04:07:28.293549 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m04:07:28.331067 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m04:07:28.384245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:07:28.384602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:07:28.405449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b17d03de-1075-41df-b829-4cd38ffded5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e6d4bd0>]}
[0m04:07:28.444047 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dags/dbt/books_dbt/target/manifest.json
[0m04:07:28.445705 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dags/dbt/books_dbt/target/semantic_manifest.json
[0m04:07:28.465135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b17d03de-1075-41df-b829-4cd38ffded5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e30bf10>]}
[0m04:07:28.465632 [info ] [MainThread]: Found 2 models, 4 data tests, 429 macros
[0m04:07:28.467787 [info ] [MainThread]: 
[0m04:07:28.468690 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:07:28.469104 [info ] [MainThread]: 
[0m04:07:28.470040 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m04:07:28.474002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_books'
[0m04:07:28.532446 [debug] [ThreadPool]: Using duckdb connection "list_books"
[0m04:07:28.532884 [debug] [ThreadPool]: On list_books: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "connection_name": "list_books"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"books"'
    
  
  
[0m04:07:28.533151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:07:28.543098 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "books_duckdb", "target_name": "dev", "connection_name": "list_books"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"books"'
    
  
  
[0m04:07:28.543392 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m04:07:28.543919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:07:28.544173 [debug] [MainThread]: Connection 'list_books' was properly closed.
[0m04:07:28.544407 [info ] [MainThread]: 
[0m04:07:28.544851 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m04:07:28.545219 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/opt/airflow/data/warehouse/books.duckdb": Conflicting lock is held in PID 0. See also https://duckdb.org/docs/stable/connect/concurrency
[0m04:07:28.546008 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.46520746, "process_in_blocks": "624", "process_kernel_time": 0.290469, "process_mem_max_rss": "143168", "process_out_blocks": "884", "process_user_time": 1.585523}
[0m04:07:28.546430 [debug] [MainThread]: Command `dbt build` failed at 04:07:28.546382 after 0.47 seconds
[0m04:07:28.546691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e324090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e33a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6923590>]}
[0m04:07:28.546957 [debug] [MainThread]: Flushing usage events
[0m04:07:29.380275 [debug] [MainThread]: An error was encountered while trying to flush usage events
